<div class="all_table relative overflow-x-auto">

    <!-- <form  class="max-w-md mx-auto mb-8">
        <div class="relative">
            <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                <svg class="w-4 h-4 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 20 20">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z" />
                </svg>
            </div>
            <input type="search" class="crud_input block w-full p-4 ps-10"
                placeholder="ابحث عن الرحلة ..." />
            <button (click)="get_searched_trips()" type="button"
                class="text-white absolute end-2.5 bottom-2.5 px-3 py-2 thirdry_bg rounded-xl">بحث</button>
        </div>
    </form> -->

    <div class="flex items-center justify-center relative">
    <h3 class="text-center  mb-8 text-[#4d4c81] text-2xl font-bold justify-self-center">
        تقارير الرحلات - {{report_name }}
    </h3>

    <button routerLink="/reports/all-reports" class="shared_btn_style thirdry_btn mb-8 absolute end-0" title="عرض كل التقارير">
         التقارير
        <span><i class="fa-solid fa-share"></i></span>
    </button>
    </div>

    <table class="w-full text-sm text-left rtl:text-right shadow rounded-xl overflow-hidden bg-white">
        <thead class="bg-gray-100 text-gray-600">
            <tr>
                <th class="px-4 py-3 text-center">#</th>
                <th class="px-4 py-3 text-center">كود الرحلة</th>
                <th class="px-4 py-3 text-center">الوجهة</th>
                <th class="px-4 py-3 text-center">التاريخ</th>
                <th class="px-4 py-3 text-center">التقارير</th>
            </tr>
        </thead>

        <tbody>
            @for(trip of all_trips ; track $index) {
            <tr class="border-t hover:bg-gray-50 transition">
                <td class="px-4 py-3 text-center">{{ $index + 1 }}</td>
                <td class="px-4 py-3 text-center font-semibold text-[#4d4c81]">{{ trip.tripCode }}</td>


                <td class="px-4 py-3 text-center">
                    @if(trip.transitCity){
                    <span>{{ trip.transitCity | enum:'city' }} <i class="fa-solid fa-location-dot px-1"></i></span>
                    }
                    {{ trip.toCity | enum:'city' }}
                </td>

                <td class="px-2 py-4 text-center">
                    <span class="crud_body_secondry_color inline-block "> {{trip.departureTime | date}} </span>
                    <span> <i class=" px-3 fa-solid fa-caret-left"></i> </span>
                    <span> {{trip.returnTime | date }} </span>
                </td>

                <td class="px-4 py-3 text-center">
                    <div class="flex justify-center gap-2 flex-wrap">

                        @if(report_type == 'bus') {
                        <!-- زر التنزيل -->
                        <button (click)="save_bus_report_Pdf(trip.id)"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-600 rounded hover:bg-blue-200 transition text-xs font-medium"
                            title="تنزيل الفاتورة">
                            تنزيل
                            <i class="fa-solid fa-file-arrow-down"></i>
                        </button>

                        <!-- زر الطباعة -->
                        <button (click)="print_bus_report(trip.id)"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-600 rounded hover:bg-purple-200 transition text-xs font-medium"
                            title="طباعة الفاتورة">
                            طباعة
                            <i class="fa-solid fa-print"></i>
                        </button>

                        <!-- زر العرض -->
                        <button (click)="open_bus_report(trip.id)"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition text-xs font-medium"
                            title="عرض الفاتورة">
                            عرض
                            <i class="fa-solid fa-eye"></i>
                        </button>
                        }






                        @if(report_type == 'trip') {
                        <!-- زر التنزيل -->
                        <button (click)="openTripTypeModal(trip.id, trip.transitCity ? true : false , 'download')"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-600 rounded hover:bg-blue-200 transition text-xs font-medium"
                            title="تنزيل الفاتورة">
                            تنزيل
                            <i class="fa-solid fa-file-arrow-down"></i>
                        </button>

                        <!-- زر الطباعة -->
                        <button (click)="openTripTypeModal(trip.id, trip.transitCity ? true : false , 'print')"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-600 rounded hover:bg-purple-200 transition text-xs font-medium"
                            title="طباعة الفاتورة">
                            طباعة
                            <i class="fa-solid fa-print"></i>
                        </button>

                        <!-- زر العرض -->
                        <button (click)="openTripTypeModal(trip.id, trip.transitCity ? true : false , 'view')"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition text-xs font-medium"
                            title="عرض الفاتورة">
                            عرض
                            <i class="fa-solid fa-eye"></i>
                        </button>
                        }




                        @if(report_type == 'manifest') {
                        <!-- زر التنزيل -->
                        <!-- <button (click)="save_manifest_report_Pdf(trip.id)" -->
                            <button (click)="openTripTypeModal(trip.id, trip.transitCity ? true : false , 'download')"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-600 rounded hover:bg-blue-200 transition text-xs font-medium"
                            title="تنزيل المنافست">
                            تنزيل
                            <i class="fa-solid fa-file-arrow-down"></i>
                        </button>

                        <!-- زر الطباعة -->
                        <!-- <button (click)="print_manifest_report(trip.id)" -->
                            <button (click)="openTripTypeModal(trip.id, trip.transitCity ? true : false , 'print')"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-600 rounded hover:bg-purple-200 transition text-xs font-medium"
                            title="طباعة المنافست">
                            طباعة
                            <i class="fa-solid fa-print"></i>
                        </button>

                        <!-- زر العرض -->
                        <!-- <button (click)="open_manifest_report(trip.id)" -->
                            <button (click)="openTripTypeModal(trip.id, trip.transitCity ? true : false , 'view')"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition text-xs font-medium"
                            title="عرض المنافست">
                            عرض
                            <i class="fa-solid fa-eye"></i>
                        </button>
                        }





                    </div>
                </td>
            </tr>
            }
        </tbody>
    </table>
</div>




<!-- Modal -->
@if(showTripTypeModal){
<div class="fixed inset-0 bg-black bg-opacity-40 z-50 flex items-center justify-center">
    <div class="bg-white rounded-xl shadow-lg p-6  w-[90%] max-w-3xl relative">

        <!-- Title -->
        <h2 class="text-xl font-bold text-center text-[#4d4c81] mb-6">{{report_type == 'trip' ? 'اختر نوع كشف الرحلة المطلوب' : 'اختر نوع كشف المنافست المطلوب'}}</h2>

        <!-- Card Options -->
        <div class="py-10 flex flex-wrap justify-center gap-4">
            <!-- ذهاب -->
            <div (click)="selectTripType(1)"
                class="w-40 cursor-pointer hover:shadow-lg border border-[#6a080859] rounded-lg p-4 text-center transition group">
                <i class="fa-solid fa-bus text-4xl text-[#6A0808] mb-2 group-hover:scale-110 transition"></i>
                <p class="font-medium cairo-font">رحلة الذهاب</p>
            </div>

            <!-- عودة -->
            <div (click)="selectTripType(2)"
                class="w-40 cursor-pointer hover:shadow-lg border border-[#6a080859] rounded-lg p-4 text-center transition group">
                <i class="fa-solid fa-van-shuttle text-4xl text-[#6A0808] mb-2 group-hover:scale-110 transition"></i>
                <p class="font-medium cairo-font">رحلة العودة</p>
            </div>

            <!-- ترانزيت -->
            @if(haveTransitCity) {
            <div (click)="selectTripType(3)"
                class="w-40 cursor-pointer hover:shadow-lg border border-[#6a080859] rounded-lg p-4 text-center transition group">
                <i class="fa-solid fa-route text-4xl text-[#6A0808] mb-2 group-hover:scale-110 transition"></i>
                <p class="font-medium cairo-font">رحلة الترانزيت</p>
            </div>
            }

            <!-- شامل -->
            <div (click)="selectTripType(null)"
                class="w-40 cursor-pointer hover:shadow-lg border border-[#6a080859] rounded-lg p-4 text-center transition group">
                <i class="fa-solid fa-file-lines text-4xl text-[#6A0808] mb-2 group-hover:scale-110 transition"></i>
                <p class="font-medium cairo-font">كشف شامل</p>
            </div>
        </div>


        <!-- Close Button -->
        <button (click)="closeTripTypeModal()" class="absolute top-2 left-3 text-gray-500 hover:text-red-500">
            <i class="fa-solid fa-xmark text-3xl p-2 px-3 hover:bg-gray-200 rounded-lg"></i>
        </button>
    </div>
</div>
}